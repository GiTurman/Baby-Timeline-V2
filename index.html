<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIDDO - AI áƒªáƒ®áƒáƒ•áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒ˜áƒ’áƒœáƒ˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #fdf6e3; font-family: sans-serif; }
        .page-card { background: white; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .loader { border: 3px solid #f3f3f3; border-radius: 50%; border-top: 3px solid #f87171; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-md mx-auto">
        <div class="flex justify-between items-center mb-8">
            <div class="flex items-center gap-3">
                <div class="bg-orange-200 p-2 rounded-lg text-2xl">ğŸ“–</div>
                <div>
                    <h1 class="text-2xl font-bold text-orange-900 leading-none">KIDDO</h1>
                    <p class="text-sm text-orange-700">Gemini 3 AI áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜</p>
                </div>
            </div>
            <button onclick="setApiKey()" class="text-xs bg-white px-2 py-1 rounded border border-orange-200 text-orange-400">ğŸ”‘ API Key</button>
        </div>

        <div class="page-card p-6 mb-10 border-t-4 border-orange-400">
            <textarea id="userNote" class="w-full border-none focus:ring-0 text-lg placeholder-orange-200 h-32 outline-none bg-transparent" placeholder="áƒáƒ¦áƒ¬áƒ”áƒ áƒ” áƒ“áƒ¦áƒ”áƒ•áƒáƒœáƒ“áƒ”áƒšáƒ˜ áƒ›áƒáƒ›áƒ”áƒœáƒ¢áƒ˜..."></textarea>
            
            <div class="flex flex-col gap-4 mt-4">
                <button id="mainBtn" onclick="generateWithAI()" class="bg-gradient-to-r from-pink-400 to-orange-400 text-white font-bold py-4 rounded-xl shadow-lg hover:scale-[1.02] transition-transform">
                    áƒ©áƒáƒ¬áƒ”áƒ áƒ” áƒ¬áƒ˜áƒ’áƒœáƒ¨áƒ˜ âœ¨
                </button>
            </div>
        </div>

        <div id="timeline" class="space-y-8"></div>
    </div>

    <script>
        function setApiKey() {
            const key = prompt("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒ¨áƒ”áƒœáƒ˜ Gemini API Key:");
            if (key) localStorage.setItem('gemini_key', key);
        }

        async function generateWithAI() {
            const note = document.getElementById('userNote').value;
            const apiKey = localStorage.getItem('gemini_key');
            const btn = document.getElementById('mainBtn');

            if (!apiKey) {
                alert("áƒ’áƒ—áƒ®áƒáƒ•áƒ—, áƒ¯áƒ”áƒ  áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒáƒ— API Key");
                return;
            }
            if (!note) return;

            btn.disabled = true;
            btn.innerHTML = '<span class="loader"></span> Gemini 3 áƒ¤áƒ˜áƒ¥áƒ áƒáƒ‘áƒ¡...';

            try {
                // áƒáƒ¥ áƒ•áƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ— Gemini 3 Flash áƒ›áƒáƒ“áƒ”áƒšáƒ¡
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-3-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `áƒ¨áƒ”áƒœ áƒ®áƒáƒ  áƒ”áƒ›áƒáƒªáƒ˜áƒ£áƒ áƒ˜ áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜áƒ¡ áƒáƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒœáƒ¢áƒ˜. áƒ’áƒáƒ“áƒáƒáƒ¥áƒªáƒ˜áƒ” áƒ”áƒ¡ áƒ›áƒáƒ™áƒšáƒ” áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ˜ áƒ—áƒ‘áƒ˜áƒš, áƒšáƒ˜áƒ¢áƒ”áƒ áƒáƒ¢áƒ£áƒ áƒ£áƒš áƒ›áƒáƒ’áƒáƒœáƒ”áƒ‘áƒáƒ“ áƒ‘áƒáƒ•áƒ¨áƒ•áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡ áƒ¥áƒáƒ áƒ—áƒ£áƒš áƒ”áƒœáƒáƒ–áƒ”: "${note}"` }] }]
                    })
                });

                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error.message);
                }

                const aiStory = data.candidates[0].content.parts[0].text;
                addMomentToTimeline(note, aiStory);
            } catch (error) {
                console.error(error);
                alert("áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ: " + error.message);
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'áƒ©áƒáƒ¬áƒ”áƒ áƒ” áƒ¬áƒ˜áƒ’áƒœáƒ¨áƒ˜ âœ¨';
                document.getElementById('userNote').value = '';
            }
        }

        function addMomentToTimeline(original, ai) {
            const timeline = document.getElementById('timeline');
            const html = `
                <div class="page-card p-6 border-l-4 border-pink-400 mb-6 animate-fade-in">
                    <p class="text-xs font-bold text-orange-400 mb-2">${new Date().toLocaleDateString('ka-GE')}</p>
                    <p class="text-gray-500 text-sm mb-3 italic">" ${original} "</p>
                    <p class="text-orange-900 leading-relaxed font-serif text-lg">${ai}</p>
                </div>
            `;
            timeline.insertAdjacentHTML('afterbegin', html);
        }
    </script>
</body>
</html>
