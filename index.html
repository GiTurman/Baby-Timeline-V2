<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIDDO - AI áƒªáƒ®áƒáƒ•áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒ˜áƒ’áƒœáƒ˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #fdf6e3; font-family: sans-serif; }
        .page-card { background: white; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.04); }
        .loader { border: 3px solid #f3f3f3; border-radius: 50%; border-top: 3px solid #ff8a8a; width: 20px; height: 20px; animation: spin 1s linear infinite; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-6">
    <div class="max-w-xl mx-auto">
        <div class="flex justify-between items-center mb-10">
            <div class="flex items-center gap-3">
                <div class="bg-orange-100 p-3 rounded-2xl text-2xl">ğŸ“–</div>
                <h1 class="text-2xl font-bold text-orange-900">KIDDO</h1>
            </div>
            <button onclick="setApiKey()" class="text-[10px] bg-white px-3 py-1 rounded-full border border-orange-100 text-orange-400">ğŸ”‘ API KEY</button>
        </div>

        <div class="page-card p-8 mb-12 border-t-4 border-orange-400">
            <textarea id="userNote" class="w-full border-none focus:ring-0 text-xl placeholder-orange-200 h-32 outline-none bg-transparent resize-none" placeholder="áƒáƒ¦áƒ¬áƒ”áƒ áƒ” áƒ”áƒ¡ áƒ¬áƒáƒ›áƒ˜ áƒ›áƒáƒ™áƒšáƒ”áƒ“..."></textarea>
            <button id="mainBtn" onclick="generateWithAI()" class="w-full mt-4 bg-gradient-to-r from-pink-400 to-orange-400 text-white font-bold py-4 rounded-xl shadow-lg flex items-center justify-center gap-3">
                <span id="btnText">áƒ©áƒáƒ¬áƒ”áƒ áƒ” áƒ¬áƒ˜áƒ’áƒœáƒ¨áƒ˜ âœ¨</span>
                <div id="loader" class="loader"></div>
            </button>
        </div>

        <div id="timeline" class="space-y-6"></div>
    </div>

    <script>
        function setApiKey() {
            const key = prompt("AIzaSyDm5B64HwQ43WtoNiPEWluf0lDY75918HY");
            if (key) localStorage.setItem('gemini_key', key);
        }

        async function generateWithAI() {
            const note = document.getElementById('userNote').value;
            const apiKey = localStorage.getItem('gemini_key');
            const btnText = document.getElementById('btnText');
            const loader = document.getElementById('loader');

            if (!apiKey) return alert("áƒ©áƒáƒ¬áƒ”áƒ áƒ” API Key!");
            if (!note) return;

            btnText.innerText = 'AI áƒ¤áƒ˜áƒ¥áƒ áƒáƒ‘áƒ¡...';
            loader.style.display = 'block';

            try {
                // áƒ¨áƒ”áƒªáƒ•áƒšáƒ˜áƒšáƒ˜ áƒ›áƒ˜áƒ¡áƒáƒ›áƒáƒ áƒ—áƒ˜: v1 áƒ“áƒ gemini-1.5-flash
                const url = `https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash:generateContent?key=${apiKey}`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `áƒ¨áƒ”áƒœ áƒ®áƒáƒ  áƒ”áƒ›áƒáƒªáƒ˜áƒ£áƒ áƒ˜ áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜áƒ¡ áƒáƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒœáƒ¢áƒ˜. áƒ’áƒáƒ“áƒáƒáƒ¥áƒªáƒ˜áƒ” áƒ”áƒ¡ áƒ›áƒáƒ™áƒšáƒ” áƒ¤áƒ áƒáƒ–áƒ áƒ—áƒ‘áƒ˜áƒš áƒ›áƒáƒ’áƒáƒœáƒ”áƒ‘áƒáƒ“ áƒ¥áƒáƒ áƒ—áƒ£áƒš áƒ”áƒœáƒáƒ–áƒ”: "${note}"` }] }]
                    })
                });

                const data = await response.json();
                
                if (data.error) throw new Error(data.error.message);

                const aiStory = data.candidates[0].content.parts[0].text;
                addStory(note, aiStory);
                document.getElementById('userNote').value = '';
            } catch (error) {
                alert("áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ: " + error.message);
                console.error(error);
            } finally {
                btnText.innerText = 'áƒ©áƒáƒ¬áƒ”áƒ áƒ” áƒ¬áƒ˜áƒ’áƒœáƒ¨áƒ˜ âœ¨';
                loader.style.display = 'none';
            }
        }

        function addStory(original, ai) {
            const timeline = document.getElementById('timeline');
            const html = `
                <div class="page-card p-6 border-l-4 border-pink-400 animate-fade-in">
                    <p class="text-xs text-orange-400 mb-2">${new Date().toLocaleDateString('ka-GE')}</p>
                    <p class="text-orange-950 font-serif text-lg font-medium">${ai}</p>
                </div>
            `;
            timeline.insertAdjacentHTML('afterbegin', html);
        }
    </script>
</body>
</html>
